                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:                         
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        else:
                        except Exception as e:
                        except Exception as e:
                        except Exception as e:
                        except Exception as e:
                        except Exception as e:
                        fin_s = []
                        fin_s = set(fin_s)
                        fin_s.append(message.sender.id)
                        flag = 1
                        for i in contact.messages:
                        for i in range(len(all_members)):
                        for i in s:
                        GFG.gfg(driver, message, wd, win1, win2)
                        if "@g.us" in message.chat_id and "@91" in msg:
                        if db_members == 0:
                        if flag == 1:
                        if len(fin_s) < 2 or len(fin_s) > 4:
                        if len(l) == 1:
                        if len(s) > 1 or message._js_obj["quotedMsgObj"]:
                        if len(s) > 2:
                        if message._js_obj["quotedMsgObj"]:
                        if message._js_obj["quotedMsgObj"]["sender"]["id"] in ignore_list:
                        if message._js_obj["quotedMsgObj"]["sender"]["id"] not in ignore_list:
                        if message.sender.id in driver.wapi_functions.getGroupAdmins(message.chat_id) or str(
                        if message.sender.id in driver.wapi_functions.getGroupAdmins(message.chat_id):
                        if message.sender.id in ludo_game_dict:
                        if message.sender.id in ludo_game_dict:
                        if message.sender.id in ludo_game_dict:
                        if message.sender.id in ludo_game_dict:
                        if message.sender.id in match_player_dict:
                        if message.sender.id in match_player_dict:
                        if message.sender.id in match_player_dict:
                        if message.sender.id in mine_player_dict:
                        if message.sender.id in mine_player_dict:
                        if message.sender.id in mine_player_dict:
                        if message.sender.id in mine_player_dict:
                        if message.sender.id in tic_player_dict:
                        if message.sender.id in tic_player_dict:
                        if message.sender.id in tic_player_dict:
                        if message.sender.id not in match_player_dict:
                        if message.sender.id not in mine_player_dict:
                        if message.sender.id not in tic_player_dict:
                        if message.type == 'chat':
                        if s != "":
                        if s != '':
                        if s != '':
                        if str(message.sender.id) == YOUR_MOBILE_NUMBER + "@c.us":
                        if str(message.sender.id) == YOUR_MOBILE_NUMBER + "@c.us":
                        if Word.start == 1:
                        if Word.start == 1:
                        if Word.start == 1:
                        if Word.start == 1:
                        if Word.start == 1:
                        l = (message.content.replace("#masskick ", "")).strip()
                        l = l.split()
                        message.chat_id)):
                        message.chat_id)):
                        message.chat_id):
                        n = 0
                        out = " ,".join(suggest.all_cmd)
                        out = ''.join(s)
                        out = cur.fetchall()
                        p = [i[0].replace("\"", "") for i in out]
                        print(fin_s)
                        s = """*Welcome to Match Emoji Game*\n\n*To end your current game send #quitmatch\n\n*To guess the pairs send #m with two pairs which you want to try matching\n*Ex. #m xy qr means xth row and yth column match with qth row and rth column\n*To check your curren game send #currmatch"""
                        s = """*Welcome to Minesweeper Game*\n\n*To choose a position send #mine xy where x is the row and y is column\n*To check your curren game send #currmine \n*To mark a position send #minemark xy\n*To unmark a position send #mineunmark xy."""
                        s = """*Welcome to the I-Bot Ludo*\n\nTo start the game send \n*#ludo*  _and tag the members you want to play with_\n\nTo roll the dice send\n*#rdice*\n\nTo move your _heart_ piece send\n*#pmove h*\n\nTo move your circle piece send \n*#pmove c*\n\nTo see current ludo board send\n*#currludo*\n\nTo quit your game send\n*#quitludo*"""
                        s = """*Welcome to the Word Game*\n\n*First join by entering your name send*\n#join _your name_\n\n*To guess the word send*\n#ans _your answer_\n\n*To check the score send*\n#score\n\n*To see the current word enter*\n#currword\n\n*If unable to guess and want to skip to the next word send*\n#skip\n\n*NOTE- IT'LL REQUIRE 3 PEOPLE TO SKIP CURRENT WORD*"""
                        s = """*Welcome to Tic Tac Toe Game*\n\n*Instructions*\n\nSend the corresponding number to the block where you want to place your symbol*\n\n#1 | #2 | #3\n#4 | #5 | #6\n#7 | #8 | #9\n*To end the game early send *#quit_tic*\n*To see your current game board uses #currtic"""
                        s = ','.join(COMP.languages)
                        s = []
                        s = int(l[0])
                        s = message.content.replace("#calc", "").strip()
                        s = message.content.replace("#cdetail", "")
                        s = message.content.replace("#cnews", "")
                        s = message.content.replace("#cprice", "")
                        s = message.content.replace("#kick", "")
                        s = message.content.replace("#ludo", "")
                        s = message.content.replace("#wiki", "")
                        s = message.content.split()
                        s = s.replace("#add", "")
                        s = s.split(" ")
                        s = message.content.replace("#calc", "").strip()
                        s = message.content.replace("#cdetail", "")
                        s = message.content.replace("#cnews", "")
                        s = message.content.replace("#cprice", "")
                        s = message.content.replace("#kick", "")
                        s = message.content.replace("#ludo", "")
                        s = message.content.replace("#wiki", "")
                        s = message.content.split()
                        s = s.replace("#add", "")
                        s = s.split(" ")
                        s = s.strip()
                        s = s.strip()
                        s = s.strip()
                        s = s.strip()
                        s = s.strip()
                        s = s.strip()
                        s.append(
                        s.append(
                        s.append(
                        s.append(
                        s.append(
                        s.append(
                        s.append(
                        s.append(
                        s.append(
                        s.append(
                        s.append(
                        size = min(12, len(message.content))
                        suggest.suggest(driver, message, message.content[:size])
                                                  size = min(12, len(message.content))
                        suggest.suggest(driver, message, message.content[:size])
                        try:
                        try:
                        try:
                        try:
                        try:
                        while db_members == 1:
                        Word.show_score(driver, message)
                    # add people to ignore list
                    # all bot commands
                    # calculator command
                    # command for checking current match game
                    # command for getting code from Geeks For Geeks
                    # command for guessing pairs in match game
                    # command for quiting match game
                    # command for starting match game
                    # command to choose position in mine map to mine
                    # command to start mine game
                    # commands for help and controls
                    # commands for playing Tic Tac Toe game
                    # commands for playing word game
                    # crypto commands
                    # driver.chat_send_message(message.chat_id,"I-Bot is inactive for this chat ⚰️\nAsk admin to send #on to turn it on.")
                    # execute the python code from the message (owner command)
                    # for getting group link
                    # for wrong command
                    # kick and add member command
                    # ludo game
                    # mass kick members
                    # reply something directly from code
                    # to delete a message
                    # to get all people message count
                    # to get msg_count
                    # to get source code
                    # to get tagged msg
                    # wikipedia command
                    bot_added[message.chat_id] = str(date.today().strftime("%Y-%m-%d"))
                    break
                    break
                    break
                    conn.commit()
                    conn.commit()
                    conn.commit()
                    cur.execute(
                    cur.execute('CALL add_chat(\'{}\',\'{}\',\'{}\')'.format("\"" + message.chat_id + "\"", 1,
                    db_members = 1
                    db_members=0
                    db_members=0
                    del all_msg[0]
                    driver.chat_send_message(message.chat_id, "Command only for admins!")
                    driver.chat_send_message(message.chat_id, "I-Bot failed to start for this chat!")
                    driver.chat_send_message(message.chat_id, "Send #help to check out all the features of bot ✨")
                    driver.chat_send_message(YOUR_MOBILE_NUMBER + "@c.us",
                    driver.chat_send_message(YOUR_MOBILE_NUMBER + "@c.us", "Starting bot for group failed" + str(e))
                    elif "#" in message.content and len(message.content) == 2 and str(message.content)[1].isdigit():
                    elif "#calc" in message.content[:5]:
                    elif "#cdetail" in message.content[:10]:
                    elif "#cnews" in message.content[:7]:
                    elif "#cprice" in message.content[:8]:
                    elif "#exec" in message.content:
                    elif "#gfg" in message.content[:5]:
                    elif "#kick" in message.content[0:6] or "#add" in message.content[:6]:
                    elif "#ludo" in message.content:
                    elif "#m " in message.content[:4]:
                    elif "#masskick " in message.content and str(message.sender.id) == YOUR_MOBILE_NUMBER + "@c.us":
                    elif "#matchgame" in message.content:
                    elif "#mine" in message.content:
                    elif "#minegame" in message.content:
                    elif "#minemark" in message.content or "#mineunmark" in message.content:
                    elif "#pmove" in message.content:
                    elif "#rdice" in message.content:
                    elif "#reply" in message.content[:6]:
                    elif "#tagalll" in message.content or "#tagadminss" in message.content:
                    elif "#wiki" in message.content[:6]:
                    elif "current transaction is aborted, commands ignored until end of transaction block" in message.content:
                    elif '#ans' in message.content[:5]:
                    elif '#join' in str(message.content)[:6]:
                    elif '#ticgame' in message.content:
                    elif (message.content == '#help' or message.content == '#command'):
                    elif len(message.content) > 5 and "#run " in message.content[0:5]:
                    elif message.content != "#on" and message.content != "#off":
                    elif message.content == "#all_cmd":
                    elif message.content == "#currludo":
                    elif message.content == "#currmatch":
                    elif message.content == "#currmine":
                    elif message.content == "#currtic":
                    elif message.content == "#delete":
                    elif message.content == "#help_ludo":
                    elif message.content == "#help_match":
                    elif message.content == "#help_mine":
                    elif message.content == "#ignore" and (message.sender.id == YOUR_MOBILE_NUMBER + "@c.us" or message.sender.id in driver.wapi_functions.getGroupAdmins(
                    elif message.content == "#ignore" and (message.sender.id == YOUR_MOBILE_NUMBER + "@c.us" or message.sender.id in driver.wapi_functions.getGroupAdmins(message.chat_id)):
                    elif message.content == "#last_tag":
                    elif message.content == "#link":
                    elif message.content == "#listlang":
                    elif message.content == "#mcount":
                    elif message.content == "#mmi":
                    elif message.content == "#msg_count":
                    elif message.content == "#ping":
                    elif message.content == "#quit_tic":
                    elif message.content == "#quitludo":
                    elif message.content == "#quitmatch":
                    elif message.content == "#quitmine":
                    elif message.content == "#resetrun":
                    elif message.content == "#runlimit":
                    elif message.content == "#source":
                    elif message.content == '#currword':
                    elif message.content == '#help_tic':
                    elif message.content == '#help_wgame':
                    elif message.content == '#score':
                    elif message.content == '#skip':
                    elif message.content == '#wordgame':
                    else:
                    for contact in driver.get_unread(include_me=True):
                    group[message.chat_id] = 1
                    if (message.type == 'chat') or (
                    if message.chat_id not in group or group[message.chat_id] == 0:
                    if message.content == '#off' and db_chats == 0 and ((
                    message = all_msg[0]
                    message.chat_id] == 1 and message.sender.id not in ignore_list:
                    pass
                    print("Adding msg count got error:\n"+str(e))
                    print("Starting bot for group failed" + str(e))
                 "#source"]
                "#currludo", "#last_tag", "#all_cmd", "#help", "#run python3#", "#run cpp#", "#resetrun", "#ticgame",
                "#currtic", "#quit_tic", "#help_tic", "#wordgame", "#currword", "#ans ", "#join ", "#score", "#skip",
                "#help_wgame", "#gfg#", "#matchgame", "#help_match", "#currmatch", "#quitmatch", "#m", "#minegame",
                "#mine ", "#currmine", "#minemark", "#mineunmark", "#help_mine", "#wiki ", "#add", "#kick", "#link",
                (hasattr(message, 'caption') and message.caption == '#sticker') or message.content[0:1] == '#'):
                break
                break
                continue
                Crypto.news(driver, "918329198682-1612849199@g.us", CRYPTOPANIC_API, "")
                Crypto.news(driver, "918329198682-1614096949@g.us", CRYPTOPANIC_API, "")
                db_chats = 0
                db_chats = 0
                db_chats = 1
                db_chats = 1
                elif message.content != "#on":
                else:
                else:
                except Exception as e:
                except Exception as e:
                if driver.is_logged_in():
                if flag == 1:
                if flag == 1:
                if messafe.type == 'chat' and content.message
                if message.content != "#on" and message.chat_id in group and group[
                if str(message.sender.id) == YOUR_MOBILE_NUMBER + "@c.us" or message.sender.id in driver.wapi_functions.getGroupAdmins(
                message.chat_id] == 1:
                print("Error Trying Again:\n"+ str(e))
                sticker.k_send_sticker(driver, message)
                time.sleep(0.8)
                time.sleep(2880)
                time.sleep(5)
                try:
                try:
            # command for creating sticker from image
            all_msg.append(message)
            bot = "on"  # setting bot status on
            break
            continue
            continue
            driver.quit()
            elif (message.type == 'image' or message.type == 'video') and message.chat_id in group and group[
            else:
            except Exception as e:
            if (time.strftime("%H:%M:%S", time.localtime()) == '15:30:00' or time.strftime("%H:%M:%S", time.localtime()) == '00:30:00' or time.strftime("%H:%M:%S",time.localtime()) == '09:30:00'):
            if flag == 1:
            if flag == 1:
            if len(all_msg) == 0 or db_members == 1:
            if message.chat_id not in group and db_chats == 0:
            if message.type == 'chat' and message.content == '#on' and db_chats == 0:
            if message.type == 'chat':
            ignore_list.add(m)
            isAdmin = lambda _: driver.wapi_functions.getMe()["wid"] in driver.wapi_functions.getGroupAdmins(_)
            m=i.replace("\"","")
            print("Bot started")
            print("Can't login trying again")
            print("Waiting for QR")
            try:
            wd.quit()
            while not driver.wait_for_login():
        conn.commit()
        cur.execute('CALL add_score(\'{}\')'.format(pname))
        except:
        for i in out[0]:
        global bot
        global d_train
        global d_train_data
        global db_chats
        global db_members
        global db_members
        global db_members
        global flag
        global k_send_sticker
        global p_adding
        global s_adding
        global s_adding
        global s_time
        global time
        if (message.type == 'chat' or message.type == 'image' or message.type == 'video') and (
        if flag == 1:
        if message.chat_id in group:
        ignore_list=set()
        ignore_list=set()
        s_adding = 0
        s_adding = 1
        threading.Thread(target=crypto_news_brodcaster).start()
        try:
        while s_adding != 0:
        while True:
        while True:
        while True:
    # Change these variable before running the bot
    # creating all classes object
    # database variables for maintaining transactions control
    # dict of group where bot can run
    # getting all_chats bot added date
    # getting score_board and players list from database
    # object dict for matchgame
    # object dict for tic game
    # object list for ludo game
    # object list for minegame
    # pre-defining varibale
    # time to noted after which whole bot restart
    #getting ignore list
    #getting players
    all_cmds = ["#delete","#calc","#cnews", "#cdetail", "#cprice", "#msg_count", "#help_ludo", "#ludo", "#rdice", "#pmove", "#quitludo",
    all_get_coun_msg = []
    all_get_tag_msg = []
    all_msg = []
    bot_added = karma_bot.db_data_to_dictionary().get(out, 3, 2)
    chrome_options = webdriver.ChromeOptions()
    chrome_options.add_argument("--disable-dev-shm-usage")
    chrome_options.add_argument("--headless")
    chrome_options.add_argument("--no-sandbox")
    chrome_options.binary_location = os.environ.get("GOOGLE_CHROME_BIN")
    COMP = karma_bot.compiler(Jdoodle_clientId, Jdoodle_clientSecret)
    conn = psycopg2.connect(os.environ.get("PGSQL_SERVER"), sslmode='require')
    Crypto = karma_bot.crypto()
    CRYPTOPANIC_API = os.environ.get('CRYPTOPANIC_API')
    cur = conn.cursor()
    cur.callproc('get_chats')
    cur.callproc('get_ignore_list')
    cur.callproc('get_player')
    cur.callproc('get_score')
    db_chats = 0
    db_members = 0
    def add_score(pname):
    def crypto_news_brodcaster():
    def main(message):
    def msg_traverse():
    driver = WhatsAPIDriver(client='chrome', headless=True, chrome_options=li,
    else:
    flag = 0
    GFG = karma_bot.GFG()
    group = karma_bot.db_data_to_dictionary().get(out, 3, 1)
    if out[0]==None:
    Jdoodle_clientId = os.environ.get("JDOODLE_CLID")
    Jdoodle_clientSecret = os.environ.get("JDOODLE_SID")
    li = [("user-data-dir=" + os.environ.get("USER_DATA")), "--disable-dev-shm-usage", "--no-sandbox"]
    ludo_game_dict = dict()
    match_player_dict = dict()
    mine_player_dict = dict()
    out = cur.fetchone()
    out = cur.fetchone()
    out = cur.fetchone()
    out=cur.fetchone()
    p_adding = 0
    player = karma_bot.db_data_to_dictionary().get(out, 2, 1)
    print(bot_added)
    print(group,(len(group)))
    quit = karma_bot.quit_bot()
    s_adding = 0
    s_time =  time.time()
    score = karma_bot.db_data_to_dictionary().get(out, 2, 1)
    sticker = karma_bot.karma_sticker()
    suggest = karma_bot.cmd_suggesstion(all_cmds)
    threading.Thread(target=msg_traverse).start()
    tic_player_dict = dict()
    wd = webdriver.Chrome(executable_path=os.environ.get("CHROMEDRIVER_PATH"), options=chrome_options)
    wd.execute_script("window.open('');")  # opening second empty tab
    wd.get("https://www.google.com/")  # opening google in one tab
    while True:
      from datetime import date
from itertools import count
from openwa import WhatsAPIDriver
from selenium import webdriver
import karma_bot
import os
    win1 = wd.window_handles[0]
    win2 = wd.window_handles[1]
    Word = karma_bot.karma_word_game(score, player)
    YOUR_MOBILE_NUMBER = os.environ.get("MOB_NUMBER")  # Ex-:   918273627374
from datetime import date
from itertools import count
from openwa import WhatsAPIDriver
from selenium import webdriver
import karma_bot
import os
import psycopg2
import threading
import time
import wikipedia
while True:
